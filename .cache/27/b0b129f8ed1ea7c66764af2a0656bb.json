{"id":"dATY","dependencies":[{"name":"/home/vitalpointai/projects/token-access/package.json","includedInParent":true,"mtime":1598480400680},{"name":"/home/vitalpointai/projects/token-access/node_modules/near-api-js/package.json","includedInParent":true,"mtime":1597967788890},{"name":"bn.js","loc":{"line":7,"column":40},"parent":"/home/vitalpointai/projects/token-access/node_modules/near-api-js/lib/validators.js","resolved":"/home/vitalpointai/projects/token-access/node_modules/near-api-js/node_modules/bn.js/lib/bn.js"}],"generated":{"js":"\"use strict\";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.diffEpochValidators=exports.findSeatPrice=void 0;const t=e(require(\"bn.js\"));function a(e,a){const r=e.map(e=>new t.default(e.stake,10)).sort((e,t)=>e.cmp(t)),d=new t.default(a),n=r.reduce((e,t)=>e.add(t));if(n.lt(d))throw new Error(\"Stakes are below seats\");let o=new t.default(1),i=n.add(new t.default(1));for(;!o.eq(i.sub(new t.default(1)));){const e=o.add(i).div(new t.default(2));let a=!1,n=new t.default(0);for(let t=0;t<r.length;++t)if((n=n.add(r[t].div(e))).gte(d)){o=e,a=!0;break}a||(i=e)}return o}function r(e,t){const a=new Map;e.forEach(e=>a.set(e.account_id,e));const r=new Set(t.map(e=>e.account_id));return{newValidators:t.filter(e=>!a.has(e.account_id)),removedValidators:e.filter(e=>!r.has(e.account_id)),changedValidators:t.filter(e=>a.has(e.account_id)&&a.get(e.account_id).stake!=e.stake).map(e=>({current:a.get(e.account_id),next:e}))}}exports.findSeatPrice=a,exports.diffEpochValidators=r;"},"sourceMaps":{"js":{"mappings":[{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":2,"column":0},"generated":{"line":1,"column":13}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":2,"column":0},"generated":{"line":1,"column":17}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":2,"column":0},"generated":{"line":1,"column":19}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":2,"column":0},"generated":{"line":1,"column":25}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":2,"column":0},"generated":{"line":1,"column":30}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":2,"column":0},"generated":{"line":1,"column":47}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":2,"column":0},"generated":{"line":1,"column":56}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":3,"column":0},"generated":{"line":1,"column":59}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":3,"column":0},"generated":{"line":1,"column":66}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":3,"column":0},"generated":{"line":1,"column":69}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":3,"column":0},"generated":{"line":1,"column":71}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":3,"column":0},"generated":{"line":1,"column":82}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":3,"column":0},"generated":{"line":1,"column":84}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":3,"column":0},"generated":{"line":1,"column":85}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":3,"column":0},"generated":{"line":1,"column":93}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":5,"column":0},"generated":{"line":1,"column":97}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":5,"column":0},"generated":{"line":1,"column":104}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":5,"column":0},"generated":{"line":1,"column":119}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":5,"column":0},"generated":{"line":1,"column":127}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":5,"column":0},"generated":{"line":1,"column":140}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":5,"column":0},"generated":{"line":1,"column":141}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":5,"column":0},"generated":{"line":1,"column":148}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":6,"column":0},"generated":{"line":1,"column":152}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":6,"column":0},"generated":{"line":1,"column":160}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":6,"column":0},"generated":{"line":1,"column":180}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":6,"column":0},"generated":{"line":1,"column":188}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":6,"column":0},"generated":{"line":1,"column":207}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":7,"column":0},"generated":{"line":1,"column":209}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":7,"column":0},"generated":{"line":1,"column":215}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":7,"column":0},"generated":{"line":1,"column":217}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":7,"column":0},"generated":{"line":1,"column":219}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":7,"column":0},"generated":{"line":1,"column":227}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":13,"column":0},"generated":{"line":1,"column":237}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":13,"column":0},"generated":{"line":1,"column":246}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":13,"column":0},"generated":{"line":1,"column":248}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":13,"column":0},"generated":{"line":1,"column":250}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":253}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":259}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":261}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":263}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":267}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":270}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":274}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":276}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":284}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":286}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":292}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":297}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":302}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":303}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":305}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":309}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":311}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":14,"column":0},"generated":{"line":1,"column":315}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":15,"column":0},"generated":{"line":1,"column":319}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":15,"column":0},"generated":{"line":1,"column":321}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":15,"column":0},"generated":{"line":1,"column":325}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":15,"column":0},"generated":{"line":1,"column":327}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":15,"column":0},"generated":{"line":1,"column":335}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":338}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":340}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":342}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":349}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":350}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":352}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":356}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":358}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":16,"column":0},"generated":{"line":1,"column":362}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":17,"column":0},"generated":{"line":1,"column":366}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":17,"column":0},"generated":{"line":1,"column":369}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":17,"column":0},"generated":{"line":1,"column":371}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":17,"column":0},"generated":{"line":1,"column":374}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":18,"column":0},"generated":{"line":1,"column":377}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":18,"column":0},"generated":{"line":1,"column":383}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":18,"column":0},"generated":{"line":1,"column":387}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":18,"column":0},"generated":{"line":1,"column":393}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":419}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":423}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":425}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":429}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":431}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":439}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":442}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":444}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":446}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":450}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":454}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":456}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":21,"column":0},"generated":{"line":1,"column":464}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":468}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":474}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":476}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":479}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":481}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":485}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":489}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":491}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":499}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":22,"column":0},"generated":{"line":1,"column":505}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":506}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":512}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":514}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":516}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":520}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":523}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":527}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":531}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":533}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":23,"column":0},"generated":{"line":1,"column":541}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":24,"column":0},"generated":{"line":1,"column":545}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":24,"column":0},"generated":{"line":1,"column":549}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":24,"column":0},"generated":{"line":1,"column":552}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":25,"column":0},"generated":{"line":1,"column":554}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":25,"column":0},"generated":{"line":1,"column":556}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":25,"column":0},"generated":{"line":1,"column":560}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":25,"column":0},"generated":{"line":1,"column":562}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":25,"column":0},"generated":{"line":1,"column":570}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":26,"column":0},"generated":{"line":1,"column":573}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":26,"column":0},"generated":{"line":1,"column":577}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":26,"column":0},"generated":{"line":1,"column":581}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":26,"column":0},"generated":{"line":1,"column":583}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":26,"column":0},"generated":{"line":1,"column":585}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":26,"column":0},"generated":{"line":1,"column":587}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":26,"column":0},"generated":{"line":1,"column":589}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":26,"column":0},"generated":{"line":1,"column":598}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":28,"column":0},"generated":{"line":1,"column":600}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":27,"column":0},"generated":{"line":1,"column":604}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":27,"column":0},"generated":{"line":1,"column":606}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":27,"column":0},"generated":{"line":1,"column":608}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":27,"column":0},"generated":{"line":1,"column":612}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":27,"column":0},"generated":{"line":1,"column":614}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":27,"column":0},"generated":{"line":1,"column":617}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":27,"column":0},"generated":{"line":1,"column":621}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":28,"column":0},"generated":{"line":1,"column":626}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":28,"column":0},"generated":{"line":1,"column":630}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":28,"column":0},"generated":{"line":1,"column":633}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":29,"column":0},"generated":{"line":1,"column":634}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":29,"column":0},"generated":{"line":1,"column":636}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":30,"column":0},"generated":{"line":1,"column":638}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":30,"column":0},"generated":{"line":1,"column":641}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":31,"column":0},"generated":{"line":1,"column":643}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":34,"column":0},"generated":{"line":1,"column":649}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":35,"column":0},"generated":{"line":1,"column":653}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":35,"column":0},"generated":{"line":1,"column":655}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":38,"column":0},"generated":{"line":1,"column":658}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":38,"column":0},"generated":{"line":1,"column":665}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":46,"column":0},"generated":{"line":1,"column":667}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":46,"column":0},"generated":{"line":1,"column":676}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":46,"column":0},"generated":{"line":1,"column":678}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":46,"column":0},"generated":{"line":1,"column":680}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":47,"column":0},"generated":{"line":1,"column":683}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":47,"column":0},"generated":{"line":1,"column":689}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":47,"column":0},"generated":{"line":1,"column":691}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":47,"column":0},"generated":{"line":1,"column":695}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":48,"column":0},"generated":{"line":1,"column":699}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":48,"column":0},"generated":{"line":1,"column":701}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":48,"column":0},"generated":{"line":1,"column":709}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":48,"column":0},"generated":{"line":1,"column":712}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":48,"column":0},"generated":{"line":1,"column":714}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":48,"column":0},"generated":{"line":1,"column":718}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":48,"column":0},"generated":{"line":1,"column":720}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":48,"column":0},"generated":{"line":1,"column":731}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":735}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":741}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":743}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":747}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":751}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":753}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":757}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":760}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":49,"column":0},"generated":{"line":1,"column":762}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":50,"column":0},"generated":{"line":1,"column":775}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":50,"column":0},"generated":{"line":1,"column":781}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":51,"column":0},"generated":{"line":1,"column":782}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":51,"column":0},"generated":{"line":1,"column":796}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":51,"column":0},"generated":{"line":1,"column":798}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":51,"column":0},"generated":{"line":1,"column":805}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":51,"column":0},"generated":{"line":1,"column":809}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":51,"column":0},"generated":{"line":1,"column":811}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":51,"column":0},"generated":{"line":1,"column":815}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":51,"column":0},"generated":{"line":1,"column":817}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":52,"column":0},"generated":{"line":1,"column":830}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":52,"column":0},"generated":{"line":1,"column":848}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":52,"column":0},"generated":{"line":1,"column":850}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":52,"column":0},"generated":{"line":1,"column":857}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":52,"column":0},"generated":{"line":1,"column":861}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":52,"column":0},"generated":{"line":1,"column":863}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":52,"column":0},"generated":{"line":1,"column":867}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":52,"column":0},"generated":{"line":1,"column":869}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":882}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":900}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":902}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":909}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":912}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":914}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":918}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":920}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":933}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":935}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":939}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":941}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":953}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":960}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":53,"column":0},"generated":{"line":1,"column":962}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":969}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":973}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":977}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":978}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":986}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":988}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":992}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":994}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":1006}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":54,"column":0},"generated":{"line":1,"column":1011}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":40,"column":0},"generated":{"line":1,"column":1017}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":40,"column":0},"generated":{"line":1,"column":1025}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":40,"column":0},"generated":{"line":1,"column":1039}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":57,"column":0},"generated":{"line":1,"column":1041}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":57,"column":0},"generated":{"line":1,"column":1049}},{"source":"../node_modules/near-api-js/lib/validators.js","original":{"line":57,"column":0},"generated":{"line":1,"column":1069}}],"sources":{"../node_modules/near-api-js/lib/validators.js":"'use strict';\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.diffEpochValidators = exports.findSeatPrice = void 0;\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\n/** Finds seat price given validators stakes and number of seats.\n *  Calculation follow the spec: https://nomicon.io/Economics/README.html#validator-selection\n * @params validators: current or next epoch validators.\n * @params numSeats: number of seats.\n */\nfunction findSeatPrice(validators, numSeats) {\n    const stakes = validators.map(v => new bn_js_1.default(v.stake, 10)).sort((a, b) => a.cmp(b));\n    const num = new bn_js_1.default(numSeats);\n    const stakesSum = stakes.reduce((a, b) => a.add(b));\n    if (stakesSum.lt(num)) {\n        throw new Error('Stakes are below seats');\n    }\n    // assert stakesSum >= numSeats\n    let left = new bn_js_1.default(1), right = stakesSum.add(new bn_js_1.default(1));\n    while (!left.eq(right.sub(new bn_js_1.default(1)))) {\n        const mid = left.add(right).div(new bn_js_1.default(2));\n        let found = false;\n        let currentSum = new bn_js_1.default(0);\n        for (let i = 0; i < stakes.length; ++i) {\n            currentSum = currentSum.add(stakes[i].div(mid));\n            if (currentSum.gte(num)) {\n                left = mid;\n                found = true;\n                break;\n            }\n        }\n        if (!found) {\n            right = mid;\n        }\n    }\n    return left;\n}\nexports.findSeatPrice = findSeatPrice;\n/** Diff validators between current and next epoch.\n * Returns additions, subtractions and changes to validator set.\n * @params currentValidators: list of current validators.\n * @params nextValidators: list of next validators.\n */\nfunction diffEpochValidators(currentValidators, nextValidators) {\n    const validatorsMap = new Map();\n    currentValidators.forEach(v => validatorsMap.set(v.account_id, v));\n    const nextValidatorsSet = new Set(nextValidators.map(v => v.account_id));\n    return {\n        newValidators: nextValidators.filter(v => !validatorsMap.has(v.account_id)),\n        removedValidators: currentValidators.filter(v => !nextValidatorsSet.has(v.account_id)),\n        changedValidators: nextValidators.filter(v => (validatorsMap.has(v.account_id) && validatorsMap.get(v.account_id).stake != v.stake))\n            .map(v => ({ current: validatorsMap.get(v.account_id), next: v }))\n    };\n}\nexports.diffEpochValidators = diffEpochValidators;\n"},"lineCount":null}},"error":null,"hash":"bcea52b02fe525313ebaeeb31072c8fe","cacheData":{"env":{}}}